<link rel="import" href="/sys/puppet-redirect/puppet-redirect.html" />
﻿<link rel="import" href="/SignIn/elements/signin-element.html" />

<template>
  <style>
    #loginBackground {
      position: absolute;
      left: 0px;
      top: 0px;
      bottom: 0px;
      right: 0px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    #loginBox {
      width: 400px;
      border-radius: 5px;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 30px;
      background-color: #4c444b;
      border: 1px solid rgba(0,0,0,0.25);
    }


    #logologin {
      width:260px;
      height:56px;
      background: url(/SignIn/images/piller_logo_fff.png);
      background-size: cover;
      margin-bottom:30px;
      transition: background 300ms ease-in 0s;
    }

    #logologin:hover {
      background: url(/SignIn/images/piller_logo_fff_c.png);
      background-size: cover;
    }


    .with-margin {
      padding: 10px;
    }

        #remember_me {
            margin-right: 5px;
        }

        #remember_me_div {
            display: flex;
            color: #BBBBBB;
        }


        @keyframes invalid
        {
          0% {transform: rotate(2deg);box-shadow: 5px 5px 5px #888888;}
          5% {transform: rotate(5deg);box-shadow: 10px 10px 10px #888888;}
          10% {transform: rotate(-5deg);box-shadow: 10px 10px 10px #888888;}
          30% {transform: rotate(2deg);box-shadow: 5px 5px 5px #888888;}
          60% {transform: rotate(-2deg);box-shadow: 5px 5px 5px #888888;}
          100% {transform: rotate(0deg);box-shadow: 0px 0px #888888;}
        }


       .shake
        {
          animation:invalid 0.5s;
        }

        .flexbox #info-box
        {
          display: none !important;
        }

        .alert {
            color: red;
        }

        #info-box
        {
          border: 2px solid red;
          display: block
        }

        input {
            padding: 8px;
            margin: 5px;
			  font-family: "Lato", Helvetica, Arial, sans-serif;
			  font-size: 12px;
			  line-height: 1.467;
			  color: #34495e;
			  border: 1px #d9d9d9 solid;
			  border-radius: 5px;
			  box-shadow: none;

			  -webkit-transition: border .25s linear, color .25s linear, background-color .25s linear;
			  transition: border .25s linear, color .25s linear, background-color .25s linear;
		  }
        button
        {
	        /*width: inherit;*/
	        min-width: 36px;
	        padding: 6px 12px;
	        margin:10px 5px;
	        font-size: 15px;
	        font-weight: normal;
	        line-height: 1.4;
	        border: 1px solid;
	        border-radius: 18px;
	        -webkit-transition: border .25s linear, color .25s linear, background-color .25s linear;
	        transition: border .25s linear, color .25s linear, background-color .25s linear;
	        -webkit-font-smoothing: subpixel-antialiased;
	        color: #fff;
	        background-color: rgba(170, 170, 170, 1);
  	        cursor: pointer;
  	        white-space: nowrap;
  	        border-color: rgba(0, 0, 0, 0.1);
    	        outline: none;
        }
        button.btn-primary
        {
	        color: #fff;
	        background-color: rgba(76, 145, 202, 1);
        }

        button.btn-primary:hover
        {
	        background-color: rgba(76, 145, 202, .75);
        }

        .fpassword {
            color: beige;
        }

     </style>
    <template is="dom-bind">
      <div id="loginBackground">
        <div class$="{{calculateClass(model.Message, model.FailedLoginCount)}}" id="loginBox">
            <template is="dom-if" if="{{!model.IsSignedIn}}">
                <div id="logologin"></div>
                 <template is="dom-if" if="{{model.Message}}">
                    <p class="alert alert-danger">{{model.Message}}</p>
                </template>

                <tu-input class="with-margin" id="txtUsername" type="text" value="{{model.Username$}}" placeholder="Username" class="form-control"></tu-input>
                <tu-input class="with-margin" id="txtPassword" type="password" value="{{local.password}}" placeholder="Password" class="form-control"></tu-input>
<!--
                <tu-input class="with-margin" autofocus="autofocus" type="text" name="username" width="100%" value="{{UserName$}}" icon="none" placeholder="Login name"></tu-input>
                <tu-input class="with-margin" type="password" name="pwd" value="{{Password$}}" icon="none" placeholder="Password"></tu-input>
                -->
                <tu-button class="btn btn-primary" on-click="signIn">Sign in</tu-button>
                <a class="fpassword" href="/tunity_users/forgot_password">Forgot password</a>
<!--                <tu-button primary class="with-margin" id="loginbtn" onclick="getModel(this).Lo gin$++" icon="arrow-circle-o-right">Login</tu-button> -->
            </template>
        </div>
        <signin-element username="{{model.Username$}}" password="{{local.password}}" remember-me="{{model.RememberMe$}}" submit="{{model.Submit}}"></signin-element>
      </div>
    </template>
    <script>
        (function () {
            var script = document._currentScript || document.currentScript;
            var template = script.previousElementSibling;

            template.local = {
                password: ""
            };

            template.txtKeypress = function (e) {
                if (e.which != 13) {
                    return;
                }
            };

            template.calculateClass = function (d, count) {
                //element.classList.remove("run-animation");
                var that = this;
                this.$.loginBox.classList.remove("shake");

                if(d != "")
                {
                  setTimeout(function(){that.$.loginBox.classList.add("shake");}, 10);
                }

                return d ? "shake"+count: "noshake";
            };

            template.signIn = function () {
                console.log('click');
                setTimeout(function () {
                    template.set("model.SignInClick$", template.model.SignInClick$ + 1);
                    window.tu.puppetDirtyCheck();
                });
            };
        })();
    </script>
</template>
