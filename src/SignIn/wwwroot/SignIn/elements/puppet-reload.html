<!-- puppet-redirect v0.1.3 forked to puppet-reload | MIT License -->
<!-- Rerequest current url when receving "reload" text -->
<script>
    (function (global) {
        var PuppetRedirectElementPrototype = Object.create(HTMLLinkElement.prototype);
        PuppetRedirectElementPrototype.attachedCallback = function () {
            this.redirect(this.getAttribute("url"));
        }
        /**
         * @event puppet-redirect-pushstate
         * Called whenever `history.state` is changed.
         * @property {String} url new URL
         */
        PuppetRedirectElementPrototype.attributeChangedCallback = function (attributeName, oldVal, newVal) {
            switch (attributeName) {
                case "url":
                    document.contains(this) && this.redirect(newVal);
                    break;
            }
        };
        PuppetRedirectElementPrototype.redirect = function (url) {
            if (!url) {
                return false;
            }
            if (url == "current") {
                url = window.location.href;
            }
            if (this.hasAttribute("history")) {
                history.pushState(null, null, url);
                this.dispatchEvent(
                    new CustomEvent(
                        "puppet-redirect-pushstate",
                        {
                            "detail": { "url": url },
                            "bubbles": true
                        }
                    )
                );
            }
            else {
                window.location = url;
            }
            this.setAttribute("url", "");
            return url;
        }
        global.PuppetRedirectElement = document.registerElement('puppet-redirect', {
            prototype: PuppetRedirectElementPrototype,
            extends: "link"
        });
    })(window);
</script>